索引结构
====

hash 索引
-------

hash 索引只适合等值查询，范围查询不合适

有序数组索引
------

有序数组索引，有利于查询，利用二分法查询，时间复杂度为 O(lgn)，范围查询也很简单，确认好小值之后，向后遍历即可。

但是，有序数组索引不适合更新，插入一个值之后，要将所有的数据都移动位置。

所以，有序数组索引适合不会改变的数据，比如：某一年城市中所有人口数据。

平衡二叉树索引
-------

查询效率为 O（lgn）。但是，数据量大的时候，树高太高，不利于存储。且依赖旋转保持平衡，操作比较耗时。

红黑树
---

红黑树，不追求平衡，查询效率下降，追求相对平衡，引入红色与黑色，方便删除。树高不可空，效率低。

b tree 索引
---------

b 树，在非叶节点上可以有多个子树，且在每个节点都存储真实数据，且树高较低，大大减少磁盘io次数。另外，利用了访问局部性原理，即：当前使用的数据，大概率马上会被使用。当访问某个数据的时候，数据库会将整个节点读到缓存中，当他临近的数据被访问时，可以直接从缓存中读取。b tree 的命中率更高，但是在范围查询时，需要多次查询。

b+tree 索引
---------

b+tree 索引是 b tree 的变种，b+tree 只在叶节点上存储数据，且是双向链表连接相邻的两个叶节点。

b+tree 非叶节点只包含键，所以保存的数据比 b tree 多，b+tree的高低更低，访问时所需的io数更少，每个节点存储的数据更多，所以对访问局部性原理利用的更好。

由于，叶子节点上是双向链表，所以更适合范围查询。且拥有更稳定的查询效率。

为什么mongdb使用b树
-------------

MongoDB 被设计为一种文档型的数据库，是一种nosql。用于 数据模型简单且性能要求高的场合。

b tree 的查询效率与树高有关，最小为 O（1），最差为 O（lgn），且 b tree key-\>value 在同一个节点上。

为什么mysql使用b+树
-------------

B 树的范围查找没有b+树合适，且b+tree在单次磁盘io查询出的数据比btree更多。因为 b+tree 在非叶子节点上不存储数据。